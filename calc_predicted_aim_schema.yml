# Used for calculating match predictions about an alliance in Server
#
# Example:
#
# {
#    "match_number": 7,
#    "team_numbers": [1678, 760, 1649],
#    "alliance_color_is_red": true,
#    "has_actual_data": true,
#    "actual_score": 8,
#    "actual_rp1": 0.0053,
#    "actual_rp2": 1.1624,
#    "won_match": false,
#    "final_predicted_score": 6.0236,
#    "final_predicted_rp1": 4.967,
#    "final_predicted_rp2": 4.692,
#    "predicted_score": 1.1766,
#    "predicted_rp1": 2.187,
#    "predicted_rp2": 4.1169,
#    "win_chance": 0.8035
# }
#


# Contains information about this schema file
schema_file:
  # Version of schema file
  # Incremented every merged schema change
  version: 2

# Fields used to calculate ensemble RP and endgame score
endgame_fields:
  onstage_rate: 
    counts: [onstage_successes, [onstage_attempts]]
    type: float
  park_rate: 
    counts: [park_successes, [park_attempts]]
    type: float
  climb_after_rate: 
    counts: [matches_climb_after, [onstage_attempts]] ###### <---- needs fix, we currently don't have a climb_after_attempts variable
    type: float
  trap_rate: 
    counts: [trap_successes, [trap_successes, trap_fails]]
    type: float

# Fields used to calculate win chance
win_chance:
  auto_avg_amp:
    sd: auto_sd_amp
    value: 2
    type: float
  auto_avg_speaker:
    sd: auto_sd_speaker
    value: 5
    type: float
  tele_avg_amp:
    sd: tele_sd_amp
    value: 1
    type: float
  tele_avg_speaker:
    sd: tele_sd_speaker
    value: 2
    type: float
  tele_avg_speaker_amped:
    sd: tele_sd_speaker_amped
    value: 5
    type: float
  avg_endgame_points:
    sd: None
    value: None
    type: float


# Stores fields that will be added to database but do not require calculations
data:
  match_number:
    type: int
  team_numbers: 
    type: List 
  alliance_color_is_red:
    type: bool
  # Whether or not actual TBA data has been pulled to replace the predicted data
  has_actual_data:
    type: bool
  actual_score:
    type: int
  # Charge RP
  actual_rp1:
    type: float
  # Link RP
  actual_rp2:
    type: float
  won_match:
    type: bool
  # Predicted values at time of the actual match
  final_predicted_score:
    type: float
    requires: [obj_team, tba_team]
  final_predicted_rp1:
    type: float
    requires: [obj_team]
  final_predicted_rp2:
    type: float
    requires: [obj_team]

# Information on predicted values that will be performed
predicted_values:
  predicted_score:
    type: float
    requires: [obj_team, tba_team]
  # TODO: find RPs when TBA updates
  predicted_rp1:
    type: float
    requires: [obj_team]
  predicted_rp2:
    type: float
    requires: [obj_team]
  win_chance:
    type: float
    requires: [obj_team]