# Used for running team calcs in Server
#
# Example:
#
# {
#     "team_number": "6",
#     "auto_avg_cone_high": 1.8843,
#     "auto_avg_cone_mid": 5.9323,
#     "auto_avg_cone_low": 2.4273,
#     "auto_avg_cone_total": 0.1843,
#     "auto_avg_cube_high": 2.4269,
#     "auto_avg_cube_mid": 0.7101,
#     "auto_avg_cube_low": 5.2911,
#     "auto_avg_cube_total": 5.1475,
#     "tele_avg_cone_high": 2.1581,
#     "tele_avg_cone_mid": 2.2104,
#     "tele_avg_cone_low": 5.8326,
#     "tele_avg_cone_total": 4.2839,
#     "tele_avg_cube_high": 4.73,
#     "tele_avg_cube_mid": 6.8621,
#     "tele_avg_cube_low": 2.9492,
#     "tele_avg_cube_total": 0.271,
#     "avg_incap_time": 3.3054,
#     "avg_gamepieces": 3.1765,
#     "avg_intakes_ground": 2.0553,
#     "avg_intakes_double": 1.6816,
#     "avg_intakes_single": 9.2346,
#     "avg_intakes_low_row": 4.5391,
#     "avg_intakes_mid_row": 4.5391,
#     "avg_intakes_high_row": 4.5391,
#     "total_intakes": 6.1126,
#     "lfm_auto_avg_cone_high": 0.4212,
#     "lfm_auto_avg_cone_mid": 2.6782,
#     "lfm_auto_avg_cone_low": 4.4792,
#     "lfm_auto_avg_cone_total": 2.4548,
#     "lfm_auto_avg_cube_high": 3.3115,
#     "lfm_auto_avg_cube_mid": 4.4592,
#     "lfm_auto_avg_cube_low": 6.3139,
#     "lfm_auto_avg_cube_total": 4.8396,
#     "lfm_tele_avg_cone_high": 5.9877,
#     "lfm_tele_avg_cone_mid": 5.0843,
#     "lfm_tele_avg_cone_low": 1.4646,
#     "lfm_tele_avg_cone_total": 6.7576,
#     "lfm_tele_avg_cube_high": 2.1547,
#     "lfm_tele_avg_cube_mid": 1.6944,
#     "lfm_tele_avg_cube_low": 1.6895,
#     "lfm_tele_avg_cube_total": 4.9494,
#     "lfm_avg_intakes_ground": 6.4241,
#     "lfm_avg_intakes_double": 1.8711,
#     "lfm_avg_intakes_single": 2.6824,
#     "lfm_avg_intakes_low_row": 3.3521,
#     "lfm_avg_intakes_mid_row": 3.3521,
#     "lfm_avg_intakes_high_row": 3.3521,
#     "lfm_total_intakes": 6.5972,
#     "lfm_avg_incap_time": 2.6824,
#     "lfm_avg_gamepieces": 4.0866,
#     "tele_avg_gamepiece_low": 5.6184,
#     "auto_sd_cone_high": 4.3532,
#     "auto_sd_cone_mid": 3.1988,
#     "auto_sd_cone_low": 1.1954,
#     "auto_sd_cone_total": 6.7162,
#     "auto_sd_cube_high": 0.9535,
#     "auto_sd_cube_mid": 5.4245,
#     "auto_sd_cube_low": 0.467,
#     "auto_sd_cube_total": 6.1142,
#     "tele_sd_cone_high": 0.6564,
#     "tele_sd_cone_mid": 3.1209,
#     "tele_sd_cone_low": 0.4901,
#     "tele_sd_cone_total": 6.7132,
#     "tele_sd_cube_high": 1.7109,
#     "tele_sd_cube_mid": 2.6629,
#     "tele_sd_cube_low": 5.8762,
#     "tele_sd_cube_total": 6.7094,
#     "sd_gamepieces": 6.4403,
#     "auto_charge_attempts": 6,
#     "auto_dock_successes": 1,
#     "auto_engage_successes": 4,
#     "tele_charge_attempts": 8,
#     "tele_dock_successes": 4,
#     "tele_engage_successes": 5,
#     "tele_park_successes": 5,
#     "position_zero_starts": 4,
#     "position_one_starts": 7,
#     "position_two_starts": 7,
#     "position_three_starts": 4,
#     "position_four_starts": 3,
#     "matches_incap": 8,
#     "total_incap": 3,
#     "matches_played": 2,
#     "lfm_position_zero_starts": 9,
#     "lfm_position_one_starts": 1,
#     "lfm_position_two_starts": 5,
#     "lfm_position_three_starts": 6,
#     "lfm_position_four_starts": 2,
#     "lfm_auto_charge_attempts": 5,
#     "lfm_auto_dock_successes": 9,
#     "lfm_auto_engage_successes": 4,
#     "lfm_tele_charge_attempts": 2,
#     "lfm_tele_dock_successes": 9,
#     "lfm_tele_engage_successes": 3,
#     "lfm_tele_park_successes": 4,
#     "lfm_matches_incap": 6,
#     "matches_tippy": 1,
#     "auto_max_cone_high": 9,
#     "auto_max_cone_mid": 1,
#     "auto_max_cone_low": 7,
#     "auto_max_cones": 6,
#     "auto_max_cube_high": 9,
#     "auto_max_cube_mid": 1,
#     "auto_max_cube_low": 7,
#     "auto_max_cubes": 8,
#     "tele_max_cone_high": 3,
#     "tele_max_cone_mid": 6,
#     "tele_max_cone_low": 3,
#     "tele_max_cones": 7,
#     "tele_max_cube_high": 8,
#     "tele_max_cube_mid": 1,
#     "tele_max_cube_low": 3,
#     "tele_max_cubes": 5,
#     "max_gamepieces": 5,
#     "max_incap": 5,
#     "max_auto_charge_level": "D",
#     "max_tele_charge_level": "P",
#     "lfm_auto_max_cone_high": 4,
#     "lfm_auto_max_cone_mid": 7,
#     "lfm_auto_max_cone_low": 8,
#     "lfm_auto_max_cones": 5,
#     "lfm_auto_max_cube_high": 8,
#     "lfm_auto_max_cube_mid": 5,
#     "lfm_auto_max_cube_low": 5,
#     "lfm_auto_max_cubes": 6,
#     "lfm_tele_max_cone_high": 6,
#     "lfm_tele_max_cone_mid": 3,
#     "lfm_tele_max_cone_low": 4,
#     "lfm_tele_max_cones": 5,
#     "lfm_tele_max_cube_high": 7,
#     "lfm_tele_max_cube_mid": 9,
#     "lfm_tele_max_cube_low": 8,
#     "lfm_tele_max_cubes": 5,
#     "lfm_max_gamepieces": 9,
#     "lfm_max_incap": 2,
#     "lfm_max_auto_charge_level": "E",
#     "lfm_max_tele_charge_level": "D",
#     "mode_preloaded_gamepiece": [
#         "B",
#         "B",
#         "B",
#         "N"
#     ],
#     "mode_start_position": [
#         3,
#         2
#     ],
#     "lfm_mode_start_position": [
#         3,
#         4,
#         1,
#         3
#     ],
#     "mode_auto_charge_level": [
#         "N",
#         "E",
#         "D"
#     ],
#     "lfm_mode_auto_charge_level": [
#         "E",
#         "D",
#         "N",
#         "N"
#     ],
#     "mode_tele_charge_level": [
#         "P",
#         "N",
#         "E"
#     ],
#     "lfm_mode_stage_level": [
#         "N",
#         "F",
#         "P",
#         "O"
#     ],
#     "charge_percent_success": 5.1098,
#     "lfm_charge_percent_success": 0.8438,
#     "tele_charge_percent_success": 4.7745,
#     "lfm_tele_charge_percent_success": 1.5471,
#     "tele_avg_charge_points": 6.8296,
#     "auto_avg_charge_points": 1.5561
# }
#

# Contains information about this schema file
schema_file:
  # Version of schema file
  # Incremented every merged schema change
  version: 1

# Stores fields that will be added to database but do not require calculations
data:
  team_number:
    type: str

# Averages of fields in consolidated TIMs
averages:
  auto_avg_amp:
    tim_fields: [obj_tim.auto_amp]
    type: float
  auto_avg_speaker:
    tim_fields: [obj_tim.auto_speaker]
    type: float
  auto_avg_total_intakes:
    tim_fields: [obj_tim.auto_total_intakes]
    type: float
  auto_avg_total_pieces:
    tim_fields: [obj_tim.auto_total_pieces]
    type: float
  tele_avg_amp:
    tim_fields: [obj_tim.tele_amp]
    type: float
  tele_avg_speaker:
    tim_fields: [obj_tim.tele_speaker]
    type: float
  tele_avg_speaker_amped:
    tim_fields: [obj_tim.tele_speaker_amped]
    type: float
  tele_avg_intakes_amp:
    tim_fields: [obj_tim.tele_intakes_amp]
    type: float
  tele_avg_intakes_center:
    tim_fields: [obj_tim.tele_intakes_center]
    type: float
  tele_avg_intakes_far:
    tim_fields: [obj_tim.tele_intakes_far]
    type: float
  tele_avg_intakes_poach:
    tim_fields: [obj_tim.tele_intakes_poach]
    type: float
  tele_avg_shoot_other:
    tim_fields: [obj_tim.tele_shoot_other]
    type: float
  tele_avg_total_intakes:
    tim_fields: [obj_tim.tele_total_intakes]
    type: float
  tele_avg_total_pieces:
    tim_fields: [obj_tim.tele_total_pieces]
    type: float
  avg_driver_ability:
    tim_fields: [subj_tim.driver_ability]
    type: float
  avg_failed_score_trap:
    tim_fields: [obj_tim.failed_score_trap]
    type: float
  avg_failed_score_amp:
    tim_fields: [obj_tim.failed_score_amp]
    type: float
  avg_failed_score_speaker:
    tim_fields: [obj_tim.failed_score_speaker]
    type: float
  avg_incap_time:
    tim_fields: [obj_tim.incap_time]
    type: float
  avg_total_intakes:
    tim_fields: [obj_tim.total_intakes]
    type: float
  avg_total_pieces:
    tim_fields: [obj_tim.total_pieces]
    type: float
  avg_trap:
    tim_fields: [obj_tim.trap]
    type: float
  lfm_auto_avg_speaker:
    tim_fields: [obj_tim.auto_speaker]
    type: float
  lfm_auto_avg_amp:
    tim_fields: [obj_tim.auto_amp]
    type: float
  lfm_auto_avg_total_intakes:
    tim_fields: [obj_tim.autos_total_intakes]
    type: float
  lfm_auto_avg_total_pieces:
    tim_fields: [obj_tim.autos_total_pieces]
    type: float
  lfm_tele_avg_speaker:
    tim_fields: [obj_tim.tele_speaker]
    type: float
  lfm_tele_avg_amp:
    tim_fields: [obj_tim.tele_amp]
    type: float
  lfm_avg_trap:
    tim_fields: [obj_tim.trap]
    type: float
  lfm_tele_avg_intakes_poach:
    tim_fields: [obj_tim.intakes_poach]
    type: float
  lfm_tele_avg_intakes_center:
    tim_fields: [obj_tim.intakes_center]
    type: float
  lfm_tele_avg_intakes_far:
    tim_fields: [obj_tim.intakes_far]
    type: float
  lfm_tele_avg_intakes_amp:
    tim_fields: [obj_tim.intakes_amp]
    type: float
  lfm_avg_incap_time:
    tim_fields: [obj_tim.incap]
    type: float
  lfm_tele_avg_shoot_other:
    tim_fields: [obj_tim.tele_shoot_other]
    type: float
  lfm_avg_failed_scores:
    tim_fields: [obj_tim.failed_score]
    type: float
  lfm_tele_avg_total_intakes:
    tim_fields: [obj_tim.tele_total_intakes]
    type: float
  lfm_tele_avg_total_pieces:
    tim_fields: [obj_tim.tele_total_pieces]
    type: float
  lfm_avg_total_intakes:
    tim_fields: [obj_tim.total_intakes]
    type: float
  lfm_avg_incap_time:
    tim_fields: [obj_tim.incap]
    type: float
  lfm_avg_failed_score_amp:
    tim_fields: [obj_tim.failed_score_amp]
    type: float
  lfm_avg_failed_score_speaker:
    tim_fields: [obj_tim.failed_score_speaker]
    type: float
  lfm_avg_failed_score_trap:
    tim_fields: [obj_tim.failed_score_trap]
    type: float
  lfm_avg_total_pieces:
    tim_fields: [obj_tim.total_pieces]
    type: float
  lfm_tele_avg_speaker_amped:
    tim_fields: [obj_tim.tele_speaker_amped]
    type: float

# Standard deviations of fields in consolidated TIMs
# Used for predictions
standard_deviations:
  auto_sd_amp:
    tim_fields: [obj_tim.auto_amp]
    type: float
  auto_sd_speaker:
    tim_fields: [obj_tim.auto_speaker]
    type: float
  auto_sd_total_intakes:
    tim_fields: [obj_tim.auto_total_intakes]
    type: float
  auto_sd_total_pieces:
    tim_fields: [obj_tim.auto_total_pieces]
    type: float
  tele_sd_amp:
    tim_fields: [obj_tim.tele_amp]
    type: float
  tele_sd_speaker:
    tim_fields: [obj_tim.tele_speaker]
    type: float
  tele_sd_speaker_amped:
    tim_fields: [obj_tim.tele_speaker_amped]
    type: float
  tele_sd_intakes_amp:
    tim_fields: [obj_tim.tele_intakes_amp]
    type: float
  tele_sd_intakes_center:
    tim_fields: [obj_tim.tele_intakes_center]
    type: float
  tele_sd_intakes_far:
    tim_fields: [obj_tim.tele_intakes_far]
    type: float
  tele_sd_intakes_poach:
    tim_fields: [obj_tim.tele_intakes_poach]
    type: float
  tele_sd_shoot_other:
    tim_fields: [obj_tim.tele_shoot_other]
    type: float
  tele_sd_total_intakes:
    tim_fields: [obj_tim.tele_total_intakes]
    type: float
  tele_sd_total_pieces:
    tim_fields: [obj_tim.tele_total_pieces]
    type: float
  sd_failed_score_amp:
    tim_fields: [obj_tim.failed_score_amp]
    type: float 
  sd_failed_score_speaker:
    tim_fields: [obj_tim.failed_score_speaker]
    type: float 
  sd_failed_score_trap:
    tim_fields: [obj_tim.failed_score_trap]
    type: float 
  sd_incap_time:
    tim_fields: [obj_tim.incap_time]
    type: float
  sd_total_intakes:
    tim_fields: [obj_tim.total_intakes]
    type: float
  sd_total_pieces:
    tim_fields: [obj_tim.total_pieces]
    type: float
  sd_trap:
    tim_fields: [obj_tim.trap]
    type: float
  lfm_auto_sd_total_pieces:
    tim_fields: [obj_tim.auto_total_pieces]
    type: float
  lfm_tele_sd_total_pieces:
    tim_fields: [obj_tim.tele_total_pieces]
    type: float

# Counts of occurrences in consolidated TIMs
counts:
  endgame_attempts:
    tim_fields:
      not:
        obj_tim.stage_level: 'N'
    type: int
  onstage_attempts:
    tim_fields:
      - obj_tim.stage_level: 'O'
      - obj_tim.stage_level: 'F'
    type: int
  onstage_successes:
    tim_fields:
      obj_tim.stage_level: 'O'
    type: int
  parks:
    tim_fields:
      obj_tim.stage_level: 'P'
    type: int
  stage_fails:
    tim_fields:
      obj_tim.stage_level: 'F'
    type: int
  position_zero_starts:
    tim_fields:
      obj_tim.start_position: '0'
    type: int
  position_one_starts:
    tim_fields:
      obj_tim.start_position: '1'
    type: int
  position_two_starts:
    tim_fields:
      obj_tim.start_position: '2'
    type: int
  position_three_starts:
    tim_fields:
      obj_tim.start_position: '3'
    type: int
  preloaded_starts:
    tim_fields:
      obj_tim.has_preload: True
    type: int
  matches_incap:
    tim_fields:
      not:
        obj_tim.incap_time: 0
    type: int
  matches_played:
    tim_fields:
      not:
        match_number: 0
    type: int
  lfm_endgame_attempts:
    tim_fields:
      not:
        obj_tim.stage_level: 'N'
    type: int
  lfm_onstage_attempts:
    tim_fields:
      - obj_tim.stage_level: 'O'
      - obj_tim.stage_level: 'F'
    type: int
  lfm_onstage_successes:
    tim_fields:
      obj_tim.stage_level: 'O'
    type: int
  lfm_parks:
    tim_fields:
      obj_tim.stage_level: 'P'
    type: int
  lfm_stage_fails:
    tim_fields:
      obj_tim.stage_level: 'F'
    type: int
  lfm_position_zero_starts:
    tim_fields:
      obj_tim.start_position: '0'
    type: int
  lfm_position_one_starts:
    tim_fields:
      obj_tim.start_position: '1'
    type: int
  lfm_position_two_starts:
    tim_fields:
      obj_tim.start_position: '2'
    type: int
  lfm_position_three_starts:
    tim_fields:
      obj_tim.start_position: '3'
    type: int
  lfm_preloaded_starts:
    tim_fields:
      obj_tim.has_preload: True
    type: int
  lfm_matches_incap:
    tim_fields:
      not:
        obj_tim.incap_time: 0
    type: int

# Objective counts collected by Super Scouts
super_counts:
  matches_tippy:
    type: int
    tim_fields: [subj_tim.was_tippy]
  lfm_matches_tippy:
    type: int
    tim_fields: [subj_tim.was_tippy]
  matches_climb_after:
    type: int
    tim_fields: [subj_tim.climb_after]
  lfm_matches_climb_after:
    type: int
    tim_fields: [subj_tim.climb_after]
  matches_played_defense:
    type: int
    tim_fields: [subj_tim.played_defense]
  lfm_matches_played_defense:
    type: int
    tim_fields: [subj_tim.played_defense]

# Maximum or minimum values in consolidated TIMs
extrema:
  auto_max_speaker:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_speaker]
  auto_max_amp:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_amp]
  auto_max_total_intakes:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_total_intakes]
  auto_max_total_pieces:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_total_pieces]
  tele_max_speaker:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_speaker]
  tele_max_amp:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_amp]
  tele_max_shoot_other:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_shoot_other]
  tele_max_total_intakes:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_max_total_intakes]
  tele_max_total_pieces:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_total_pieces]
  max_trap:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.trap]
  max_incap_time:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.incap_time]
  max_failed_scores:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.failed_score]
  max_total_intakes:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.total_intakes]
  max_total_pieces:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.total_pieces]
  lfm_auto_max_speaker:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_speaker]
  lfm_auto_max_amp:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_amp]
  lfm_auto_max_total_intakes:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_total_intakes]
  lfm_auto_max_total_pieces:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.auto_total_pieces]
  lfm_tele_max_speaker:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_speaker]
  lfm_tele_max_amp:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_amp]
  lfm_tele_max_shoot_other:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_shoot_other]
  lfm_tele_max_total_intakes:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_max_total_intakes]
  lfm_tele_max_total_pieces:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.tele_total_pieces]
  lfm_max_trap:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.trap]
  lfm_max_incap_time:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.incap_time]
  lfm_max_failed_scores:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.failed_score]
  lfm_max_total_intakes:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.total_intakes]
  lfm_max_total_pieces:
    extrema_type: max
    type: int
    tim_fields: [obj_tim.total_pieces]

# Most common values
modes:
  mode_start_position:
    tim_fields: [obj_tim.start_position]
    ignore: '0'
    type: List
  lfm_mode_start_position:
    tim_fields: [obj_tim.start_position]
    ignore: '0'
    type: List
  mode_stage_level:
    tim_fields: [obj_tim.stage_level]
    ignore: 'N'
    type: List
  lfm_mode_stage_level:
    tim_fields: [obj_tim.stage_level]
    ignore: 'N'
    type: List

success_rates:
  onstage_percent_success:
    team_successes: [onstage_successes]
    team_attempts: [onstage_attempts]
    type: float
  lfm_onstage_percent_success:
    team_successes: [lfm_onstage_successes]
    team_attempts: [lfm_onstage_attempts]
    type: float
  onstage_percent:
    team_successes: [onstage_successes]
    team_attempts: [endgame_attempts]
    type: float
  park_percent:
    team_successes: [parks]
    team_attempts: [endgame_attempts]
    type: float

# Calculates all the medians
medians:
  median_nonzero_incap_time: 
    tim_fields: [obj_tim.incap_time]
    ignore: 0
    type: float
  lfm_median_nonzero_incap_time:
    tim_fields: [obj_tim.incap_time]
    ignore: 0
    type: float

# Calculates a sum of fields multiplied by point values
sums:
  auto_avg_total_points:
    auto_avg_amp : 2
    auto_avg_speaker : 5
    type: float
  tele_avg_total_points:
    tele_avg_amp: 1
    tele_avg_speaker: 2
    tele_avg_speaker_amped: 5
    type: float
  avg_endgame_points:
    onstage_percent: 3
    park_percent: 1
    avg_trap: 5
    type: float
  avg_total_points:
    auto_avg_total_points: 1
    tele_avg_total_points: 1
    avg_endgame_points: 1
    type: float
  total_incap:
    type: int
  lfm_total_incap:
    type: int